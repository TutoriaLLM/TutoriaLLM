<h1 align="center">
Kids Code Tutorial(仮称) <br /> <a href="https://github.com/google/blockly"><img src="https://tinyurl.com/built-on-blockly" /> </a>
</h1>

Kids Code Tutorial は、小中学生を対象とした、Web 上で使用できる、LLM によって提供されるセルフホスト型プログラミング学習プラットフォームです。教育コンテンツを制作する人と、そのコンテンツから学ぶ人たちのために設計されています。

このプロジェクトは 2024 年度の未踏ジュニアに採択され、最終報告会（11 月）までにすべての機能が使用できるようになる予定です。

多少現在の内容とはズレがありますが、プロジェクトを開始した当初の説明動画です。

[https://youtu.be/Emb5GYgJis0?si=cTiSOld8gMYnfne2](https://youtu.be/Emb5GYgJis0?si=cTiSOld8gMYnfne2)

## 設計

現在このアプリの大部分はまだ開発中です。開発に参加していただける方はぜひ[Discord コミュニティ](https://discord.gg/nAmPrUzVsN)内のkids-code-turtorialチャンネルへご参加ください。

- コンテンツ提供者
  - 教育を提供したことのある方は、このアプリをホストすることで、AIが人間に代わって、より多くの人に質の高いプログラミングの授業を提供することができます。人間がアプリ内に提供したコンテンツをもとに、AI がユーザーへチュートリアルを提供します。
  - 学校やプログラミング教室、フリースクールなどの教育施設内での小規模な利用を想定しています。
    - Dockerを利用することで、お手持ちのサーバーからすぐに開始することができます。
- 学習者
  - ブラウザからアプリにアクセスするだけで、すぐにチュートリアルを開始することができます。AI がリアルタイムな対話を提供することにより、一方的な動画やスライドのチュートリアルと比べて、わからないところをすぐに質問したり、フィードバックを得ることができるようになるため、効率よく学習することができます。

### 拡張機能
コード開発ができるコンテンツ提供者は、拡張機能を作成することで、ユーザーがアプリで使える機能を増やすことができます。このページ下部の「追加で使用できる機能」セクションをご覧ください。

## アプリを使ってみる

### 開発サーバーの起動

> コマンドの詳細は[docker-compose.yml](docker-compose.yml)を参照してください。

VSCodeなどを利用してコードを編集することができます。

また、サーバーはDockerを利用してホストすることができます。以下のコマンドで開発サーバーを起動します：
```
docker compose up --build
```

HMR(Hot Module Replacement)を使用したい場合は、以下のコマンドで起動します。ファイルを変更すると自動的にリロードされます。
```
docker compose watch
```

また、以下の環境変数をプロジェクトのルートフォルダ内に作成した`.env`に記載してください：
 - AUTH_SECRET - 認証設定で使用するシークレット
 - OPENAI_API_KEY - GPTを使用するためのキー

 - DB_USER - データベースのユーザー名
 - DB_PASSWORD - データベースのパスワード
 - DB_HOST - データベースのホスト名。docker-composeファイルを変更していない場合は`db`を指定してください。
 - DB_NAME - データベースの名前

 - PORT - アプリが使用するポート番号
 - SSL - SSLの設定（true/false）

### サーバーでアプリを稼働させる（実稼働）

> コマンドの詳細は[docker-compose.prod.yml](docker-compose.prod.yml)を参照してください。

自前のサーバーで稼働させる場合は以下のコマンドで実稼働アプリをビルドし、起動させます。アプリを稼働させるには以下の環境変数が必要です：
 - AUTH_SECRET - 認証設定で使用するシークレット
 - OPENAI_API_KEY - GPTを使用するためのAPIキー

 - DB_USER - データベースのユーザー名
 - DB_PASSWORD - データベースのパスワード
 - DB_HOST - データベースのホスト名。docker-composeファイルを変更していない場合は`db`を指定してください。
 - DB_NAME - データベースの名前。デフォルトは"code_tutorial_db"です。
 - PORT - アプリが使用するポート番号。80や8080など、使用可能なポート番号を指定してください。
 - SSL - SSLの設定（true/false）。実稼働環境ではSSLを有効にすることをお勧めします。

```
docker compose -f docker-compose.prod.yml up
```

### Docker Hubから取得する
[Docker Hub](https://hub.docker.com/r/soumame/code-tutorial-app)からイメージを取得することも可能です。PostgreSQL, Redisと接続する必要があります。

> 注意：SSLが必須のプラットフォームにデプロイすると、Minecraft-Core拡張機能が正常に動作しない可能性があります。Minecrtaftの`/connect`コマンド自体がSSLに対応していないため、現時点においてこの問題を解決するためには、SSLを無効にするか、Minecraft-Core拡張機能を無効にする必要があります。

### 認証情報と初期チュートリアルのリセット
> これらのコマンドは初めてDocker composeコマンドを実行した際に自動的に実行されます。`app`イメージ内の`.initialized`ファイルの存在を確認して、初期化が必要かどうかを判断しています。

必要がある場合は、コンテナ内の`app`イメージを起動させた状態で、以下のコマンドを実行してください。
```
npm run reset-credential
```

初期チュートリアル（拡張機能から提供されるチュートリアル）も以下の方法でリセットできます。このチュートリアルも自動で実行されているので、不要な場合は管理者画面から削除してください。
```
npm run reset-tutorial
```
### アプリの設定をする

管理者画面にアクセスすることで、アプリの設定を変更することができます。設定は以下の項目があります：
- ダッシュボード
- チュートリアルの管理
- セッションの一覧
- ユーザーの一覧
- サーバー設定


#### アクセス方法
- アプリを稼働させた状態で、`/admin`へアクセスします。
- 初期ユーザー名は`admin`、パスワードは`admin`です。

## 追加で使用できる機能

- [言語](src/i18n/): リポジトリ内のすべてのプログラムで多言語対応をしています。現在は４つの言語に対応していますが、いくつかの言語は機械翻訳によって生成されています。

  - 英語
  - 日本語
  - マレー語
  - 中国語簡体字

- [拡張機能](app/src/extensions/): 拡張機能を追加することで、新しいブロック、ツールボックスカテゴリ、VM(ブロックから変換されたユーザーのコードをnode vm moduleを使用して実行します) を実行する際に使用できる追加の関数（context）を設定することができます。
  - [Example(開発中)](src/extensions/Example/): 拡張機能の雛形として使用できるサンプルです。
  - [Minecraft-Core(開発中)](app/src/extensions/Minecraft-Core/): Minecraft と本アプリを接続することができる拡張機能です。
  - [web](app/src/extensions/web/): 簡単なwebアプリを作成し、サーバーサイドで実行することができます。